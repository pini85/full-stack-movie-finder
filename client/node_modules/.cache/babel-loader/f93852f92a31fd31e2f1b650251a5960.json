{"ast":null,"code":"var _jsxFileName = \"/home/pinchas/code/projects/movie-finder/src/components/Search/Search.component.jsx\";\nimport React, { useEffect, useState } from \"react\";\nimport { connect } from \"react-redux\";\nimport { withRouter } from \"react-router-dom\";\nimport { compose } from \"redux\";\nimport { search, fetchMovies, movieSuggestions, showSearchResults, fetchCastSuggestion } from \"../../redux/actions\";\nimport { tmdbQueryApi } from \"../../apis/tmdbApi\";\nimport Suggestions from \"../Suggestions/Suggestions.component\";\nimport Button from \"../Button/Button\";\nimport Input from \"../Input/Input.component\"; // import useDidUpdateEffect from \"../../hooks/useDidUpdateEffect.hooks\";\n\nimport useWidth from \"../../hooks/useWidth.hooks\";\n\nconst Search = props => {\n  const [searchQuery, setSearchQuery] = useState(\"\");\n  const width = useWidth().width;\n  useEffect(() => {\n    const search = async () => {\n      const data = await tmdbQueryApi(1, searchQuery);\n      props.fetchMovieSuggestions(data);\n      props.fetchCastSuggestion(null, searchQuery, true);\n    };\n\n    if (searchQuery && !props.movieSuggestions.length) {\n      search();\n    } else {\n      const timeOutId = setTimeout(async () => {\n        if (searchQuery) {\n          search();\n        } else {\n          props.fetchMovieSuggestions(false);\n        }\n      }, 100);\n      return () => {\n        clearTimeout(timeOutId);\n      };\n    } // setTimeout(async () => {\n    //   const data = !!searchQuery.length && (await tmdbQueryApi(1, searchQuery));\n    //   props.fetchCastSuggestion(null, searchQuery, true);\n    //   props.fetchMovieSuggestions(data);\n    // }, 150);\n\n  }, [searchQuery]);\n\n  const handleClick = () => {\n    props.search(searchQuery);\n    props.fetchMovies(1);\n    props.showSearchResults(\"search\");\n    setSearchQuery(\"\");\n\n    if (width < 500) {\n      props.setOpen(val => !val);\n    }\n\n    props.history.push(`/search/q=${searchQuery}/page/1`);\n  };\n\n  const handleKeyDown = e => {\n    if (e.keyCode === 13) {\n      handleClick();\n    }\n  };\n\n  const container = {\n    display: \"flex\",\n    alignItems: \"center\"\n  };\n\n  const handleChange = e => {\n    setSearchQuery(e.target.value); // props.search(e.target.value);\n  };\n\n  return /*#__PURE__*/React.createElement(\"div\", {\n    onKeyDown: handleKeyDown,\n    style: container,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 78,\n      columnNumber: 5\n    }\n  }, /*#__PURE__*/React.createElement(Input, {\n    value: searchQuery,\n    handleOnChange: handleChange,\n    placeholder: \"The world is your oyster...\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 79,\n      columnNumber: 7\n    }\n  }), /*#__PURE__*/React.createElement(Button, {\n    search: true,\n    title: \"search\" // disabled={isSending}\n    ,\n    handleClick: e => handleClick(e),\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 84,\n      columnNumber: 7\n    }\n  }), props.movieSuggestions && /*#__PURE__*/React.createElement(Suggestions, {\n    setSearchQuery: setSearchQuery,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 92,\n      columnNumber: 9\n    }\n  }));\n};\n\nconst mapStateToProps = state => ({\n  isSending: state.isSending,\n  // fetchMoves: state.fetchMovies,\n  selectedMovies: state.selectedMovies,\n  movieSuggestions: state.movieSuggestions,\n  castSuggestions: state.castSuggestions,\n  query: state.search\n});\n\nexport default compose(withRouter, connect(mapStateToProps, {\n  search: search,\n  fetchMovies: page => fetchMovies(page),\n  fetchMovieSuggestions: movieSuggestions,\n  showSearchResults: showSearchResults,\n  fetchCastSuggestion: fetchCastSuggestion\n}))(Search);","map":{"version":3,"sources":["/home/pinchas/code/projects/movie-finder/src/components/Search/Search.component.jsx"],"names":["React","useEffect","useState","connect","withRouter","compose","search","fetchMovies","movieSuggestions","showSearchResults","fetchCastSuggestion","tmdbQueryApi","Suggestions","Button","Input","useWidth","Search","props","searchQuery","setSearchQuery","width","data","fetchMovieSuggestions","length","timeOutId","setTimeout","clearTimeout","handleClick","setOpen","val","history","push","handleKeyDown","e","keyCode","container","display","alignItems","handleChange","target","value","mapStateToProps","state","isSending","selectedMovies","castSuggestions","query","page"],"mappings":"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","sourcesContent":["import React, { useEffect, useState } from \"react\";\nimport { connect } from \"react-redux\";\nimport { withRouter } from \"react-router-dom\";\nimport { compose } from \"redux\";\nimport {\n  search,\n  fetchMovies,\n  movieSuggestions,\n  showSearchResults,\n  fetchCastSuggestion,\n} from \"../../redux/actions\";\nimport { tmdbQueryApi } from \"../../apis/tmdbApi\";\nimport Suggestions from \"../Suggestions/Suggestions.component\";\nimport Button from \"../Button/Button\";\nimport Input from \"../Input/Input.component\";\n// import useDidUpdateEffect from \"../../hooks/useDidUpdateEffect.hooks\";\nimport useWidth from \"../../hooks/useWidth.hooks\";\n\nconst Search = (props) => {\n  const [searchQuery, setSearchQuery] = useState(\"\");\n  const width = useWidth().width;\n\n  useEffect(() => {\n    const search = async () => {\n      const data = await tmdbQueryApi(1, searchQuery);\n      props.fetchMovieSuggestions(data);\n      props.fetchCastSuggestion(null, searchQuery, true);\n    };\n    if (searchQuery && !props.movieSuggestions.length) {\n      search();\n    } else {\n      const timeOutId = setTimeout(async () => {\n        if (searchQuery) {\n          search();\n        } else {\n          props.fetchMovieSuggestions(false);\n        }\n      }, 100);\n      return () => {\n        clearTimeout(timeOutId);\n      };\n    }\n\n    // setTimeout(async () => {\n    //   const data = !!searchQuery.length && (await tmdbQueryApi(1, searchQuery));\n    //   props.fetchCastSuggestion(null, searchQuery, true);\n\n    //   props.fetchMovieSuggestions(data);\n    // }, 150);\n  }, [searchQuery]);\n\n  const handleClick = () => {\n    props.search(searchQuery);\n    props.fetchMovies(1);\n    props.showSearchResults(\"search\");\n    setSearchQuery(\"\");\n    if (width < 500) {\n      props.setOpen((val) => !val);\n    }\n    props.history.push(`/search/q=${searchQuery}/page/1`);\n  };\n  const handleKeyDown = (e) => {\n    if (e.keyCode === 13) {\n      handleClick();\n    }\n  };\n\n  const container = {\n    display: \"flex\",\n    alignItems: \"center\",\n  };\n  const handleChange = (e) => {\n    setSearchQuery(e.target.value);\n    // props.search(e.target.value);\n  };\n\n  return (\n    <div onKeyDown={handleKeyDown} style={container}>\n      <Input\n        value={searchQuery}\n        handleOnChange={handleChange}\n        placeholder=\"The world is your oyster...\"\n      />\n      <Button\n        search={true}\n        title={\"search\"}\n        // disabled={isSending}\n        handleClick={(e) => handleClick(e)}\n      ></Button>\n\n      {props.movieSuggestions && (\n        <Suggestions setSearchQuery={setSearchQuery} />\n      )}\n    </div>\n  );\n};\n\nconst mapStateToProps = (state) => ({\n  isSending: state.isSending,\n  // fetchMoves: state.fetchMovies,\n  selectedMovies: state.selectedMovies,\n  movieSuggestions: state.movieSuggestions,\n  castSuggestions: state.castSuggestions,\n  query: state.search,\n});\n\nexport default compose(\n  withRouter,\n  connect(mapStateToProps, {\n    search: search,\n    fetchMovies: (page) => fetchMovies(page),\n    fetchMovieSuggestions: movieSuggestions,\n    showSearchResults: showSearchResults,\n    fetchCastSuggestion: fetchCastSuggestion,\n  })\n)(Search);\n"]},"metadata":{},"sourceType":"module"}